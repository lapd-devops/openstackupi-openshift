---
# file: roles/uninstall/tasks/main.yml
- name: Delete all instances
  os_server:
     state: absent
     cloud: "{{ os_project }}"
     name: "{{ inventory_hostname }}"
     delete_fip: yes
- name: Delete all port allocations
  os_port:
     state: absent
     cloud: "{{ os_project }}"
     name: "{{ inventory_hostname }}"
- name: Delete the router
  run_once: true
  os_router:
     cloud: "{{ os_project }}"
     state: absent
     name: "{{ router_name }}"
- name: Delete the subnet
  run_once: true
  os_subnet:
     cloud: "{{ os_project }}"
     state: absent
     name: "{{ subnet_name }}"
- name: Delete the network
  run_once: true
  os_network:
     cloud: "{{ os_project }}"
     state: absent
     name: "{{ network_name }}"
- name: Delete the user
  run_once: true
  os_user:
     cloud: "{{ os_admin }}"
     state: absent
     name: "{{ ospuser }}"
- name: Delete the project
  run_once: true
  os_project:
     cloud: "{{ os_admin }}"
     state: absent
     name: "{{ project }}"
